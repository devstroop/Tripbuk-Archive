@layout UserLayout
@page "/management/masters/units/conversions/edit/{Id}"
@attribute [Authorize]

<PageTitle>Edit Unit Conversion</PageTitle>
<RadzenRow>
    <RadzenColumn SizeMD="9">
        <RadzenLabel style="font-weight: bold" Text="Item no longer available." Visible="@(!_canEdit)"/>
    </RadzenColumn>
    <RadzenColumn SizeMD="3">
        <RadzenButton ButtonStyle="ButtonStyle.Secondary" style="margin-bottom: 20px" Text="Close" Visible="@(!_canEdit)"
                      Click="@CancelButtonClick"/>
    </RadzenColumn>
</RadzenRow>
<RadzenRow>
    <RadzenColumn SizeMD="9">
        <RadzenLabel style="font-weight: bold"
                     Text="Another user has made conflicting changes to one or more of the fields you have modified. Please reload."
                     Visible="@_hasChanges"/>
    </RadzenColumn>
    <RadzenColumn SizeMD="3">
        <RadzenButton ButtonStyle="ButtonStyle.Secondary" Icon="autorenew" style="margin-bottom: 20px" Text="Reload"
                      Visible="@_hasChanges" Click="@ReloadButtonClick"/>
    </RadzenColumn>
</RadzenRow>

<RadzenColumn SizeMD=12>
    <RadzenAlert Shade="Shade.Lighter" Variant="Variant.Flat" Size="AlertSize.Small" AlertStyle="AlertStyle.Danger"
                 Visible="@_errorVisible">Cannot save UnitConversion
    </RadzenAlert>
    <RadzenTemplateForm TItem="ERP.Server.Models.Postgres.UnitConversion" Data="@_unitConversion"
                        Visible="@(_unitConversion != null && _canEdit)" Submit="@FormSubmit">
        <RadzenRow style="margin-bottom: 1rem">
            <RadzenColumn SizeMD="3">
                <RadzenLabel Text="Main Unit" Component="MainUnit" style="width: 100%"/>
            </RadzenColumn>
            <RadzenColumn SizeMD="9">
                <RadzenDropDownDataGrid Data="@_unitsForMainUnit" TextProperty="UnitName" ValueProperty="Id"
                                        AllowClear="true"
                                        Placeholder="Choose Unit" style="display: block; width: 100%"
                                        @bind-Value="@_unitConversion.MainUnit" Name="MainUnit"
                                        SelectedValue="@_unitsForMainUnitValue" Count="@_unitsForMainUnitCount"
                                        LoadData="@UnitsForMainUnitLoadData"/>
                <RadzenRequiredValidator Component="MainUnit" Text="Main unit is required"/>
            </RadzenColumn>
        </RadzenRow>
        <RadzenRow style="margin-bottom: 1rem">
            <RadzenColumn SizeMD="3">
                <RadzenLabel Text="Sub Unit" Component="SubUnit" style="width: 100%"/>
            </RadzenColumn>
            <RadzenColumn SizeMD="9">
                <RadzenDropDownDataGrid Data="@_unitsForSubUnit" TextProperty="UnitName" ValueProperty="Id"
                                        AllowClear="true"
                                        Placeholder="Choose Unit" style="display: block; width: 100%"
                                        @bind-Value="@_unitConversion.SubUnit" Name="SubUnit"
                                        SelectedValue="@_unitsForSubUnitValue" Count="@_unitsForSubUnitCount"
                                        LoadData="@UnitsForSubUnitLoadData"/>
                <RadzenRequiredValidator Component="SubUnit" Text="Sub unit is required"/>
            </RadzenColumn>
        </RadzenRow>
        <RadzenRow style="margin-bottom: 1rem">
            <RadzenColumn SizeMD="3">
                <RadzenLabel Text="Conversion Factor" Component="ConversionFactor" style="width: 100%"/>
            </RadzenColumn>
            <RadzenColumn SizeMD="9">
                <RadzenNumeric style="display: block; width: 100%" @bind-Value="@_unitConversion.ConversionFactor"
                               Name="ConversionFactor"/>
            </RadzenColumn>
        </RadzenRow>
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center"
                     JustifyContent="JustifyContent.End" Gap="0.5rem">
            <RadzenButton ButtonStyle="ButtonStyle.Primary" ButtonType="ButtonType.Submit" Icon="save" Text="Save"
                          Variant="Variant.Flat"/>
            <RadzenButton ButtonStyle="ButtonStyle.Light" Text="Cancel" Variant="Variant.Flat"
                          Click="@CancelButtonClick"/>
        </RadzenStack>
    </RadzenTemplateForm>
</RadzenColumn>

